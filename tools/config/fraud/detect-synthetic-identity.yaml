name: detect-synthetic-identity
description: |
  Identifies potential synthetic identities by finding clusters of
  identities sharing PII elements without legitimate relationship explanation.

intent: |
  Detect synthetic identity fraud where a person combines real and fake identity
  information to open accounts or make purchases - using real information (photos,
  passport numbers) mixed with fake information (fake name, address, date of birth).

  Detection uses Neo4j's graph link analysis - exploring connections among identities
  to identify synthetic clusters and suspicious relationship patterns.

expected_patterns:
  - entity: Customer
    shared_elements: [Email, Phone, Passport]
    anomaly: Multiple customers sharing the same email, phone, or passport without legitimate relationship
  - entity: Customer PII Community
    shared_elements: [Email, Phone, Passport]
    anomaly: Connected component of customers linked through shared attributes - use GDS WCC algorithm

reference_cypher: |
  // Customers sharing email
  MATCH path=(c1:Customer)-[:HAS_EMAIL]->(:Email)<-[:HAS_EMAIL]-(c2:Customer)
  RETURN path

  // Multiple shared characteristics
  MATCH path=(c1:Customer)-[:HAS_EMAIL|HAS_PHONE|HAS_PASSPORT]->(info)<-[:HAS_EMAIL|HAS_PHONE|HAS_PASSPORT]-(c2:Customer)
  RETURN path

  // Create monopartite relationships for GDS
  MATCH (c1:Customer)-[:HAS_EMAIL|HAS_PHONE|HAS_PASSPORT]->(info)<-[:HAS_EMAIL|HAS_PHONE|HAS_PASSPORT]-(c2:Customer)
  WHERE ID(c1) > ID(c2)
  CREATE (c1)-[:LINKED]->(c2)

  // GDS: Project graph and run WCC
  CALL gds.graph.project('myGraph', 'Customer', 'LINKED')
  CALL gds.wcc.stream('myGraph')
  YIELD nodeId, componentId
  RETURN gds.util.asNode(nodeId).customerId AS customerId, componentId
  ORDER BY componentId

reference_schema:
  labels: [Customer, Email, Phone, Passport]
  relationships: [HAS_EMAIL, HAS_PHONE, HAS_PASSPORT, LINKED]

parameters:
  - name: minSharedAttributes
    type: integer
    default: 2
    description: Minimum number of shared attributes to flag as suspicious
  - name: limit
    type: integer
    default: 20
    description: Maximum number of results to return
  - name: customerId
    type: string
    description: Optional - specific customer ID to investigate (omit for discovery mode)
